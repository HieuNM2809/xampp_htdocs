"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7091],{29248:function(e,t,a){var n=a(68216),r=a(25997),o=a(39249),i=function(){function e(t){(0,n.Z)(this,e),this.api=t}return(0,r.Z)(e,[{key:"uploadAttachments",value:function(e,t,a,n,r){var i=this;if(!e)return null;var c=e;if(c.constructor!==Array)c=[e];else if(!c.length)return null;var s=[],h=c.filter((function(e){return e.shoudDelete}));s.push(this.deleteAttachments(h,n));var l=c.filter((function(e){return!e.shoudDelete&&e.shouldUpload&&(e.image||e.video)})),m=[],u="".concat(a||t?"/posts":"/threads","/attachments"),d=function(e){if(e.errors)throw Error.new(e.errors.toString());return m.push(e.attachment),e.attachment},_=function(e){throw e};return l.forEach((function(e){var o=function(e,t,a,n,r){console.log("GetFormData",e);var o=new window.FormData;return a?o.append("post_id",a):t?o.append("thread_id",t):o.append("forum_id",n),!r&&e.blob?o.append("file",e.blob,e.jpgName):o.append("file",e.raw),o}(e,t,a,n,r),c=i.api.post({uri:u,body:o}).then(d,_);s.push(c)})),Promise.all(s).catch((function(e){throw o.Am.error(e),i.deleteAttachments(m,n),e}))}},{key:"deleteSingleAttachment",value:function(e,t){return e?this.api.del({uri:"/threads/attachments",params:{forum_id:t,attachment_id:e.attachment_id}}).then((function(){}),console.log):null}},{key:"deleteAttachments",value:function(e,t){var a=this,n=[],r=function(e){var r=a.deleteSingleAttachment(e,t);r&&n.push(r)};return e.length?this.api.batch((function(){return e.map(r)})).then((function(){return Promise.all(n)})).catch(console.log):[]}}]),e}();t.Z=i},60352:function(e,t,a){a.d(t,{Z:function(){return C}});var n=a(83789),r=a(30266),o=a(68216),i=a(25997),c=a(14695),s=a(13444),h=a(30268),l=a(92953),m=a(65988),u=a(809),d=a.n(u),_=a(67294),p=a(92809);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,p.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=a(16373)({features:["js","ww"]}),x=function(){var e=(0,r.Z)(d().mark((function e(t){var a,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=window.document.createElement("canvas"),t.width>1200?(a.width=1200,a.height=1200/t.width*t.height):(a.height=1200,a.width=1200/t.height*t.width),e.prev=2,e.next=5,k.resize(t,a,void 0);case 5:return e.next=7,k.toBlob(a,"image/jpeg",1);case 7:return n=e.sent,console.log("blob: ",n),e.abrupt("return",{blob:n});case 12:return e.prev=12,e.t0=e.catch(2),console.log(e.t0),"C\xf3 l\u1ed7i khi resize \u1ea3nh. \u1ea2nh s\u1ebd \u0111\u01b0\u1ee3c upload v\u1edbi k\xedch th\u01b0\u1edbc g\u1ed1c.",e.abrupt("return",{error:"C\xf3 l\u1ed7i khi resize \u1ea3nh. \u1ea2nh s\u1ebd \u0111\u01b0\u1ee3c upload v\u1edbi k\xedch th\u01b0\u1edbc g\u1ed1c."});case 17:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),b=function(e){return new Promise((function(t){var a=new window.FileReader;a.onload=function(a){var n=a.target.result,o=new window.Image;o.onload=(0,r.Z)(d().mark((function a(){var r,i;return d().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r={},i="".concat(e.raw.name.split(".").slice(0,-1).join("."),".jpg"),!(o.width>1200||o.height>1200)){a.next=6;break}return a.next=5,x(o);case 5:r=a.sent;case 6:t(f(f({},e),{},{image:n,jpgName:i},r));case 7:case"end":return a.stop()}}),a)}))),o.src=a.target.result},a.readAsDataURL(e.raw)}))},v=[".attachment-container.jsx-2798031272{overflow-y:auto;max-height:35vh;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:12px;}",".image-picker-image-container.jsx-2798031272{width:20%;position:relative;box-sizing:border-box;display:inline-block;}","@media (min-width:320px){.image-picker-image-container.jsx-2798031272{width:31%;}}","@media (min-width:768px){.image-picker-image-container.jsx-2798031272{width:24%;}}","@media (min-width:992px){.image-picker-image-container.jsx-2798031272{width:24%;}}",".image-picker.jsx-2798031272 .loading-icon.jsx-2798031272{margin-left:0.5rem;}",".image-picker-loading.jsx-2798031272{position:absolute;top:0;left:0;bottom:0;right:0;}",".image-picker-image.jsx-2798031272{padding-top:100%;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;}",".image-picker-image-del.jsx-2798031272{position:absolute;top:2px;right:8px;color:white;font-size:20px;text-shadow:2px 2px 2px black;cursor:pointer;}",".image-picker-error.jsx-2798031272{position:absolute;top:5px;left:5px;bottom:5px;right:5px;padding:10px;background:rgba(0,0,0,0.8);color:white;font-size:13px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:1.5;}",".tinhteFact-container.jsx-2798031272{margin-top:12px;}",".tinhteFact-title.jsx-2798031272{font-size:24px;font-weight:bold;color:var(--color-accent-light);background-color:var(--color-dark-2);padding:12px;text-align:center;text-transform:uppercase;}",".tinhteFact-img.jsx-2798031272{display:block;}",".tinhteFact-body.jsx-2798031272{font-size:20px;color:var(--color-light-0);background-color:var(--color-dark-2);padding:12px;text-align:center;}","@media (max-width:700px){.tinhteFact-title.jsx-2798031272{font-size:18px;padding:8px;}.tinhteFact-body.jsx-2798031272{font-size:16px;padding:8px;}}"];v.__hash="2798031272";var w=v,y=a(85893);function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,h.Z)(this,a)}}var C=function(e){(0,s.Z)(a,e);var t=j(a);function a(e){var n;return(0,o.Z)(this,a),(n=t.call(this,e)).state={loading:!1,error:""},n.onSizeTypeChanged=n.onSizeTypeChanged.bind((0,c.Z)(n)),n.onFileInputChange=n.onFileInputChange.bind((0,c.Z)(n)),n.removeFile=n.removeFile.bind((0,c.Z)(n)),n}return(0,i.Z)(a,[{key:"onSizeTypeChanged",value:function(e){this.props.onSizeTypeChanged(e.target.checked)}},{key:"onFileInputChange",value:function(){var e=(0,r.Z)(d().mark((function e(t){var a,r,o,i,c,s,h,l,m,u,_;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.files,r=this.props,o=r.limit,i=r.onNewImages,c=t.target.files,c=(0,n.Z)(c)){e.next=6;break}return e.abrupt("return");case 6:if(!this.state.loading){e.next=8;break}return e.abrupt("return");case 8:if(this.setState({error:"",loading:!0}),s=a.reduce((function(e,t){return e+(t.shoudDelete?0:1)}),0),console.log("files",c),h=c.filter((function(e){return e.type.match("image.*")||e.type.match("video.*")})),l=!1,c.forEach((function(e){e.type.match("video.*")&&(l=!0)})),!(o&&s+h.length>o)){e.next=17;break}return this.setState({error:"B\u1ea1n ch\u1ec9 \u0111\u01b0\u1ee3c \u0111\u0103ng m\u1ed9t l\xfac t\u1ed1i \u0111a ".concat(o," file"),loading:!1}),e.abrupt("return");case 17:if(l){e.next=26;break}return h=h.map((function(e){return{raw:e,shouldUpload:!0}})),m=h.map((function(e){return b(e).catch((function(e){console.log(e)}))})),e.next=22,Promise.all(m);case 22:u=e.sent,i(u),e.next=28;break;case 26:_=c.map((function(e){return{raw:e,shouldUpload:!0,video:!0}})),i(_);case 28:this.setState({loading:!1});case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"show",value:function(){this.fileInput.value=null,this.fileInput.click()}},{key:"removeFile",value:function(e){this.props.removeFile(e),this.setState({error:""})}},{key:"renderFiles",value:function(){var e=this;return this.props.files.map((function(t,a){return t.shoudDelete?(0,y.jsx)("div",{},a):(0,y.jsxs)("div",{className:"jsx-".concat(w.__hash)+" image-picker-image-container",children:[(0,y.jsx)("div",{style:{backgroundImage:t.image?"url(".concat(t.image,")"):"none"},className:"jsx-".concat(w.__hash)+" image-picker-image"}),(0,y.jsx)("div",{className:"jsx-".concat(w.__hash)+" image-picker-loading box center-xs middle-xs",children:t.image?(0,y.jsx)("div",{className:"jsx-".concat(w.__hash)}):(0,y.jsx)("i",{style:{color:"#757575",fontSize:20},className:"jsx-".concat(w.__hash)+" fa fa-spinner fa-spin"})}),t.error&&(0,y.jsx)("div",{className:"jsx-".concat(w.__hash)+" image-picker-error",children:t.error}),(0,y.jsx)("button",{onClick:function(){e.removeFile(a)},className:"jsx-".concat(w.__hash)+" image-picker-image-del",children:(0,y.jsx)("i",{"aria-hidden":"true",className:"jsx-".concat(w.__hash)+" fa fa-times"})}),(0,y.jsx)(m.default,{id:w.__hash,children:w})]},a)}))}},{key:"render",value:function(){var e=this,t=this.props.files.length>0;return(0,y.jsxs)("div",{className:"jsx-".concat(w.__hash),children:[this.state.loading&&(0,y.jsx)("i",{style:{display:t?"none":"inline-block"},className:"jsx-".concat(w.__hash)+" fa fa-spinner fa-spin"}),(0,y.jsxs)("div",{style:{display:t?"block":"none"},className:"jsx-".concat(w.__hash)+" image-picker box",children:[(0,y.jsx)("input",{style:{display:"none"},type:"file",multiple:!0,ref:function(t){e.fileInput=t},onChange:this.onFileInputChange,className:"jsx-".concat(w.__hash)}),this.state.error&&(0,y.jsx)("p",{style:{color:"red",fontSize:14,padding:"0 5px"},className:"jsx-".concat(w.__hash)+" full-width",children:this.state.error}),t&&(0,y.jsx)("div",{title:"ch\u1ecdn k\xedch th\u01b0\u1edbc g\u1ed1c s\u1ebd \u1ea3nh h\u01b0\u1edfng t\u1ed1c \u0111\u1ed9 \u0111\u0103ng \u1ea3nh v\xe0 c\xf3 th\u1ec3 d\u1eabn \u0111\u1ebfn \u1ea3nh b\u1ecb \u1ea9n \u0111i",style:{fontSize:12},className:"jsx-".concat(w.__hash)+" full-width",children:this.state.loading&&(0,y.jsx)("i",{className:"jsx-".concat(w.__hash)+" loading-icon fa fa-spinner fa-spin"})}),(0,y.jsx)("div",{className:"jsx-".concat(w.__hash)+" attachment-container",children:this.renderFiles()})]}),(0,y.jsx)(m.default,{id:w.__hash,children:w})]})}}]),a}(_.Component)},490:function(e,t,a){a.d(t,{Q:function(){return n},n5:function(){return r},$Q:function(){return o}});var n="news_feed_visit",r=function(e){firebase.analytics().setUserId(e)},o=function(e,t){var a=firebase.analytics();t?a.logEvent(e,t):a.logEvent(e)}},22244:function(e,t){t.Z={tinhteHomeGAEventCategory:"TinhteHome_Home",tinhteSummaryGAEventCategory:"TinhteHome_Summary",gaEventClick:"click",gaEventPageLoad:"tinhte_page_load",gaEventImpression:"impression",gaEventViewable:"viewable",gaHomeEnter:"home_enter",gaHeaderMenuForum:"home_header_forum",gaHeaderMenuCamera:"home_header_camera",gaHeaderMenuXe:"home_header_xe",gaHeaderMenuNhattao:"home_header_nhattao",gaHeaderMenuFeed:"home_header_feed",gaHeaderMenuCommunity:"home_header_community",gaHeaderMenuFlyfood:"home_header_flyfood",gaHeaderMenuPodcast:"home_header_podcast",gaHeaderMenuVideo:"home_header_video",gaHeaderMenuEzviz:"home_header_ezviz",gaChannelMenuForum:"home_channel_forum",gaChannelMenuCamera:"home_channel_camera",gaChannelMenuXe:"home_channel_xe",gaChannelMenuNhattao:"home_channel_nhattao",gaChannelMenuYoutube:"home_channel_youtube",gaHeaderLinkItem:"home_header_link_item",gaHeaderEventItem:"home_header_event_item",gaLoadMorePromotedThread:"home_load_more_promoted_threads",gaTopPromotion:"home_top_promotion",gaMainPromotion:"home_main_promotion",gaTopThread:"home_top_thread",gaDailyDiscussion:"home_daily_discussion",gaYearReview:"home_year_in_review_main_promotion",gaYearReviewFacebookShare:"year_in_review_share_facebook_button",gaYearReviewEnter:"year_in_review_enter",gaTopTrendTag:"home_top_trend_tag",gaSubTrendTag:"home_sub_trend_tag",gaTopTrendThreadTag:"home_sub_trend_thread_tag",gaThreadSelfLoadMore:"home_threadself_load_more",gaUnansweredPost:"home_unanswered_post_item",gaUnansweredPostTopHome:"home_unanswered_post_item_at_top",gaAppIntro:"home_app_intro_image",gaAppiOSDownload:"home_app_ios_download_button",gaAppAndroidDownload:"home_app_android_download_button",gaHomeThreadListItem:"home_thread_list_item",gaHomeThreadListViewMore:"home_thread_list_view_more",gaNewsRecapButton:"home_news_recap_button",gaMainMyFeedButton:"home_hero_my_feed_button",gaSummaryNewsLink:"summary_news_link",gaSummaryTagLink:"summary_tag_link",gaSummaryBackToHomeButton:"summary_back_to_home_button",gaHeroBottomPromotionClick:"home_hero_bottom_promotion",gaRelatedThreadClick:"home_related_thread_click",gaRelatedThreadClose:"home_related_thread_close",gaTinhteFactItemClick:"home_tinhtefact_item_click",gaTinhteFactItemAuthorClick:"home_tinhtefact_item_author_click",gaTinhteFactPreviewItemClick:"home_tinhtefact_preview_item_click",gaTinhteFactCreateItemClick:"home_tinhtefact_create_item_click",gaTinhteFactPreviewItemAuthorClick:"home_tinhtefact_preview_item_author_click",gaHomeHotStreamItemClick:"home_hot_stream_item_click",gaHomeHotStreamViewMoreClick:"home_hot_stream_view_more_click",gaCreateLongFormClick:"home_new_thread_create_longform_click",gaCategorySelectorClick:"home_category_selector_click",gaStayHomeBanner:"home_stay_home_click",gaHeroStreamCarouselHeaderClick:"home_hero_stream_carousel_header_click_",gaHeroStreamCarouselFirstTitleClick:"home_hero_stream_carousel_first_title_click",gaHeroStreamCarouselItemClick:"home_hero_stream_carousel_item_click",gaHeroStreamCarouselViewMoreClick:"home_hero_stream_carousel_view_more_click",gaTabHeaderHome:"home_tab_header_home",gaTabHeaderForU:"home_tab_header_foru",gaSpecialThreadsByTagClick:"home_special_threads_by_tag_click",tinhteDeeptalkCategory:"TinhteHome_Deeptalk",gaDeeptalkPageItemClick:"deeptalk_item_click"}}}]);